impl super::IsKeyDownRaw for WinKey {
  fn is_down_raw(&self) -> bool {
    unsafe { (GetKeyState(*self as i32) & 0x80) == 0x80 }
  }
}

impl super::IsKeyDownRaw for u16 {
  fn is_down_raw(&self) -> bool {
    unsafe { (GetKeyState(i32::from(*self)) & 0x80) == 0x80 }
  }
}

#[allow(dead_code)]
#[repr(u16)]
#[derive(
  Debug, Clone, Copy, PartialEq, Eq, Hash, wm_macros::TryToDiscriminant,
)]
pub enum WinKey {
  A = 65u16,
  AbntC1 = 193u16,
  AbntC2 = 194u16,
  Accept = 30u16,
  Add = 107u16,
  Apps = 93u16,
  Attn = 246u16,
  B = 66u16,
  Back = 8u16,
  BrowserBack = 166u16,
  BrowserFavorites = 171u16,
  BrowserForward = 167u16,
  BrowserHome = 172u16,
  BrowserRefresh = 168u16,
  BrowserSearch = 170u16,
  BrowserStop = 169u16,
  C = 67u16,
  Cancel = 3u16,
  Capital = 20u16,
  Clear = 12u16,
  Control = 17u16,
  Convert = 28u16,
  Crsel = 247u16,
  D = 68u16,
  D0 = 48u16,
  D1 = 49u16,
  D2 = 50u16,
  D3 = 51u16,
  D4 = 52u16,
  D5 = 53u16,
  D6 = 54u16,
  D7 = 55u16,
  D8 = 56u16,
  D9 = 57u16,
  Decimal = 110u16,
  Delete = 46u16,
  Divide = 111u16,
  Down = 40u16,
  E = 69u16,
  End = 35u16,
  Ereof = 249u16,
  Escape = 27u16,
  Execute = 43u16,
  Exsel = 248u16,
  F = 70u16,
  F1 = 112u16,
  F10 = 121u16,
  F11 = 122u16,
  F12 = 123u16,
  F13 = 124u16,
  F14 = 125u16,
  F15 = 126u16,
  F16 = 127u16,
  F17 = 128u16,
  F18 = 129u16,
  F19 = 130u16,
  F2 = 113u16,
  F20 = 131u16,
  F21 = 132u16,
  F22 = 133u16,
  F23 = 134u16,
  F24 = 135u16,
  F3 = 114u16,
  F4 = 115u16,
  F5 = 116u16,
  F6 = 117u16,
  F7 = 118u16,
  F8 = 119u16,
  F9 = 120u16,
  Final = 24u16,
  G = 71u16,
  GamepadA = 195u16,
  GamepadB = 196u16,
  GamepadDpadDown = 204u16,
  GamepadDpadLeft = 205u16,
  GamepadDpadRight = 206u16,
  GamepadDpadUp = 203u16,
  GamepadLeftShoulder = 200u16,
  GamepadLeftThumbstickButton = 209u16,
  GamepadLeftThumbstickDown = 212u16,
  GamepadLeftThumbstickLeft = 214u16,
  GamepadLeftThumbstickRight = 213u16,
  GamepadLeftThumbstickUp = 211u16,
  GamepadLeftTrigger = 201u16,
  GamepadMenu = 207u16,
  GamepadRightShoulder = 199u16,
  GamepadRightThumbstickButton = 210u16,
  GamepadRightThumbstickDown = 216u16,
  GamepadRightThumbstickLeft = 218u16,
  GamepadRightThumbstickRight = 217u16,
  GamepadRightThumbstickUp = 215u16,
  GamepadRightTrigger = 202u16,
  GamepadView = 208u16,
  GamepadX = 197u16,
  GamepadY = 198u16,
  H = 72u16,
  Help = 47u16,
  Home = 36u16,
  I = 73u16,
  Ico00 = 228u16,
  IcoClear = 230u16,
  IcoHelp = 227u16,
  ImeOff = 26u16,
  ImeOn = 22u16,
  Insert = 45u16,
  J = 74u16,
  Junja = 23u16,
  K = 75u16,
  Kana = 21u16,
  Kanji = 25u16,
  L = 76u16,
  LaunchApp1 = 182u16,
  LaunchApp2 = 183u16,
  LaunchMail = 180u16,
  LaunchMediaSelect = 181u16,
  LButton = 1u16,
  LControl = 162u16,
  Left = 37u16,
  LMenu = 164u16,
  LShift = 160u16,
  LWin = 91u16,
  M = 77u16,
  MButton = 4u16,
  MediaNextTrack = 176u16,
  MediaPlayPause = 179u16,
  MediaPrevTrack = 177u16,
  MediaStop = 178u16,
  Menu = 18u16,
  ModeChange = 31u16,
  Multiply = 106u16,
  N = 78u16,
  NavigationAccept = 142u16,
  NavigationCancel = 143u16,
  NavigationDown = 139u16,
  NavigationLeft = 140u16,
  NavigationMenu = 137u16,
  NavigationRight = 141u16,
  NavigationUp = 138u16,
  NavigationView = 136u16,
  Next = 34u16,
  NoName = 252u16,
  NonConvert = 29u16,
  Numlock = 144u16,
  Numpad0 = 96u16,
  Numpad1 = 97u16,
  Numpad2 = 98u16,
  Numpad3 = 99u16,
  Numpad4 = 100u16,
  Numpad5 = 101u16,
  Numpad6 = 102u16,
  Numpad7 = 103u16,
  Numpad8 = 104u16,
  Numpad9 = 105u16,
  O = 79u16,
  Oem1 = 186u16,
  Oem102 = 226u16,
  Oem2 = 191u16,
  Oem3 = 192u16,
  Oem4 = 219u16,
  Oem5 = 220u16,
  Oem6 = 221u16,
  Oem7 = 222u16,
  Oem8 = 223u16,
  OemAttn = 240u16,
  OemAuto = 243u16,
  OemAx = 225u16,
  OemBacktab = 245u16,
  OemClear = 254u16,
  OemComma = 188u16,
  OemCopy = 242u16,
  OemCusel = 239u16,
  OemEnlw = 244u16,
  OemFinish = 241u16,
  OemFjLoya = 149u16,
  OemFjMasshou = 147u16,
  OemFjRoya = 150u16,
  OemFjTouroku = 148u16,
  OemJump = 234u16,
  OemMinus = 189u16,
  OemNecEqual = 146u16,
  OemPa1 = 235u16,
  OemPa2 = 236u16,
  OemPa3 = 237u16,
  OemPeriod = 190u16,
  OemPlus = 187u16,
  OemReset = 233u16,
  OemWsCtrl = 238u16,
  P = 80u16,
  PA1 = 253u16,
  Packet = 231u16,
  Pause = 19u16,
  Play = 250u16,
  Print = 42u16,
  Prior = 33u16,
  Processkey = 229u16,
  Q = 81u16,
  R = 82u16,
  Rbutton = 2u16,
  RControl = 163u16,
  Return = 13u16,
  Right = 39u16,
  RMenu = 165u16,
  RShift = 161u16,
  RWin = 92u16,
  S = 83u16,
  Scroll = 145u16,
  Select = 41u16,
  Separator = 108u16,
  Shift = 16u16,
  Sleep = 95u16,
  Snapshot = 44u16,
  Space = 32u16,
  Subtract = 109u16,
  T = 84u16,
  Tab = 9u16,
  U = 85u16,
  Up = 38u16,
  V = 86u16,
  VolumeDown = 174u16,
  VolumeMute = 173u16,
  VolumeUp = 175u16,
  W = 87u16,
  X = 88u16,
  XButton1 = 5u16,
  XButton2 = 6u16,
  Y = 89u16,
  Z = 90u16,
  Zoom = 251u16,
  None = 255u16,
}

// Aliases for keys that have duplicate key codes
#[allow(non_upper_case_globals, dead_code)]
impl WinKey {
  pub const DbeAlphanumeric: WinKey = WinKey::OemAttn;
  pub const DbeCodeinput: WinKey = WinKey::Play;
  pub const DbeDbcschar: WinKey = WinKey::OemEnlw;
  pub const DbeDeterminestring: WinKey = WinKey::NoName;
  pub const DbeEnterdlgconversionmode: WinKey = WinKey::PA1;
  pub const DbeEnterimeconfigmode: WinKey = WinKey::Exsel;
  pub const DbeEnterwordregistermode: WinKey = WinKey::Crsel;
  pub const DbeFlushstring: WinKey = WinKey::Ereof;
  pub const DbeHiragana: WinKey = WinKey::OemCopy;
  pub const DbeKatakana: WinKey = WinKey::OemFinish;
  pub const DbeNocodeinput: WinKey = WinKey::Zoom;
  pub const DbeNoroman: WinKey = WinKey::Attn;
  pub const DbeRoman: WinKey = WinKey::OemBacktab;
  pub const DbeSbcschar: WinKey = WinKey::OemAuto;

  pub const Hangeul: WinKey = WinKey::Kana;
  pub const Hangul: WinKey = WinKey::Kana;
  pub const HANJA: WinKey = WinKey::Kanji;

  pub const OemFjJisho: WinKey = WinKey::OemNecEqual;
}
